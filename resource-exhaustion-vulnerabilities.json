{
  "scanDate": "2025-12-22",
  "repository": "traf3li-backend",
  "totalVulnerabilities": 37,
  "criticalCount": 22,
  "highCount": 15,
  "mediumCount": 0,
  "vulnerabilities": [
    {
      "id": "RE-001",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/message.controller.js",
      "line": "97-100",
      "function": "getMessages",
      "description": "Message query without .limit() - loads all messages in conversation",
      "dosPotenttial": "EXTREME",
      "impact": "Memory exhaustion, application crash",
      "attackComplexity": "LOW",
      "attackScenario": "Attacker sends 100,000 messages to conversation, victim opens it, app crashes",
      "remediation": "Add pagination with max limit of 100 items",
      "estimatedFixTime": "15 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-002",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/conversation.controller.js",
      "line": "28",
      "function": "getConversations",
      "description": "Loads all conversations without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Memory exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Attacker creates 10,000 fake accounts, each initiates conversation with target",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-003",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/invoice.controller.js",
      "line": "81-84",
      "function": "getInvoices",
      "description": "Loads all invoices without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Memory exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Lawyer creates 50,000 fake invoices, opens invoice list",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-004",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/case.controller.js",
      "line": "101-105",
      "function": "getCases",
      "description": "Loads all cases without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Memory exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Create thousands of cases, load cases page",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-005",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/gig.controller.js",
      "line": "82",
      "function": "getGigs",
      "description": "Loads all gigs without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Network bandwidth exhaustion, client crash",
      "attackComplexity": "LOW",
      "attackScenario": "Attacker creates 100,000 gigs, public searches with broad filter",
      "remediation": "Add pagination with max 100 per page",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-006",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/order.controller.js",
      "line": "8-17",
      "function": "getOrders",
      "description": "Loads all orders without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Memory exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Create thousands of orders, load orders page",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-007",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/user.controller.js",
      "line": "44-52",
      "function": "getLawyerProfile",
      "description": "Loads all gigs and all reviews without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Memory exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Create 1000 gigs and 100,000 reviews, view profile",
      "remediation": "Add limits to both queries",
      "estimatedFixTime": "15 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-008",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "355",
      "function": "generateRevenueReport",
      "description": "Invoice query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload, memory exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Request report with 100-year date range",
      "remediation": "Add date range validation (max 1 year) and pagination",
      "estimatedFixTime": "30 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-009",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "396",
      "function": "generateAgingReport",
      "description": "Invoice query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "15 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-010",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "455",
      "function": "generateCollectionsReport",
      "description": "Payment query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "15 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-011",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "500",
      "function": "generateProductivityReport",
      "description": "TimeEntry query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "15 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-012",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "546",
      "function": "generateProfitabilityReport",
      "description": "Invoice query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "15 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-013",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "554",
      "function": "generateProfitabilityReport",
      "description": "Expense query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-014",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "587",
      "function": "generateTimeUtilizationReport",
      "description": "TimeEntry query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-015",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "630",
      "function": "generateTaxReport",
      "description": "Invoice query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-016",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "645",
      "function": "generateTaxReport",
      "description": "Expense query without limit",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload",
      "attackComplexity": "LOW",
      "remediation": "Add pagination",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-017",
      "category": "Unbounded Database Query",
      "severity": "CRITICAL",
      "file": "src/controllers/dashboard.controller.js",
      "line": "238-243",
      "function": "getRecentMessages",
      "description": "Conversation query without limit",
      "dosPotenttial": "HIGH",
      "impact": "Memory exhaustion",
      "attackComplexity": "LOW",
      "remediation": "Add limit to conversation query",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-018",
      "category": "Report Date Range",
      "severity": "CRITICAL",
      "file": "src/controllers/report.controller.js",
      "line": "44-45",
      "function": "generateReport",
      "description": "No validation on date range size - allows 100+ year ranges",
      "dosPotenttial": "EXTREME",
      "impact": "Database overload querying millions of records",
      "attackComplexity": "LOW",
      "attackScenario": "Request report from 1900-2100",
      "remediation": "Validate max date range (365 days)",
      "estimatedFixTime": "10 minutes",
      "priority": "P0",
      "fixed": false
    },
    {
      "id": "RE-019",
      "category": "Socket.io Connection Limit",
      "severity": "HIGH",
      "file": "src/configs/socket.js",
      "line": "17-70",
      "function": "initSocket",
      "description": "No limit on connections per IP or user",
      "dosPotenttial": "HIGH",
      "impact": "Connection exhaustion, file descriptor limit",
      "attackComplexity": "LOW",
      "attackScenario": "Open 10,000 WebSocket connections",
      "remediation": "Limit to 10 connections per IP",
      "estimatedFixTime": "20 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-020",
      "category": "Socket.io Message Size",
      "severity": "HIGH",
      "file": "src/configs/socket.js",
      "line": "52-55",
      "function": "message:send",
      "description": "No validation on message data size",
      "dosPotenttial": "HIGH",
      "impact": "Memory exhaustion, event loop blocking",
      "attackComplexity": "LOW",
      "attackScenario": "Send 100MB message object",
      "remediation": "Validate message size < 1MB",
      "estimatedFixTime": "10 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-021",
      "category": "Socket.io Room Limit",
      "severity": "HIGH",
      "file": "src/configs/socket.js",
      "line": "38-41",
      "function": "conversation:join",
      "description": "No limit on rooms per socket",
      "dosPotenttial": "MODERATE",
      "impact": "Memory exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Join 10,000 rooms from single socket",
      "remediation": "Limit to 50 rooms per socket",
      "estimatedFixTime": "10 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-022",
      "category": "Socket.io Event Rate Limit",
      "severity": "HIGH",
      "file": "src/configs/socket.js",
      "line": "44-60",
      "function": "typing:start, message:send",
      "description": "No rate limiting on socket events",
      "dosPotenttial": "HIGH",
      "impact": "CPU exhaustion, event loop blocking",
      "attackComplexity": "LOW",
      "attackScenario": "Send 1000 typing events per second",
      "remediation": "Rate limit events to 5 per second",
      "estimatedFixTime": "15 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-023",
      "category": "Bulk Operations",
      "severity": "HIGH",
      "file": "src/controllers/notification.controller.js",
      "line": "182-206",
      "function": "createBulkNotifications",
      "description": "No validation on array size for insertMany",
      "dosPotenttial": "MODERATE",
      "impact": "Database overload, memory exhaustion",
      "attackComplexity": "MEDIUM",
      "attackScenario": "Pass 1 million notifications to bulk insert",
      "remediation": "Validate array size, max 100 items",
      "estimatedFixTime": "10 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-024",
      "category": "File Upload - No Count Limit",
      "severity": "HIGH",
      "file": "src/configs/multer.js",
      "line": "N/A",
      "description": "No limit on number of files uploaded per user",
      "dosPotenttial": "HIGH",
      "impact": "Disk space exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Upload 1000 files × 10MB = 10GB per user",
      "remediation": "Add file count limit (5 per request), global quota per user",
      "estimatedFixTime": "30 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-025",
      "category": "File Upload - No Per-User Quota",
      "severity": "HIGH",
      "file": "N/A",
      "description": "No tracking or enforcement of per-user storage limits",
      "dosPotenttial": "HIGH",
      "impact": "Disk space exhaustion",
      "attackComplexity": "LOW",
      "attackScenario": "Multiple users fill disk to 100%",
      "remediation": "Implement per-user quotas (500MB-5GB by role)",
      "estimatedFixTime": "45 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-026",
      "category": "File Upload - No Disk Monitoring",
      "severity": "HIGH",
      "file": "N/A",
      "description": "No alerts when disk usage reaches critical levels",
      "dosPotenttial": "MODERATE",
      "impact": "Disk full → application failure",
      "attackComplexity": "LOW",
      "remediation": "Add disk space monitoring with alerts at 90%, 95%",
      "estimatedFixTime": "30 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-027",
      "category": "File Upload - Concurrent Upload",
      "severity": "HIGH",
      "file": "src/configs/multer.js",
      "line": "35-41",
      "description": "No limit on concurrent file uploads",
      "dosPotenttial": "HIGH",
      "impact": "I/O saturation, all requests timeout",
      "attackComplexity": "LOW",
      "attackScenario": "100 concurrent uploads × 10MB each",
      "remediation": "Apply uploadRateLimiter (already exists)",
      "estimatedFixTime": "5 minutes",
      "priority": "P1",
      "fixed": false
    },
    {
      "id": "RE-028",
      "category": "ReDoS",
      "severity": "MEDIUM",
      "file": "src/controllers/user.controller.js",
      "line": "135-136",
      "function": "getLawyers",
      "description": "Unsanitized user input in regex",
      "dosPotenttial": "MODERATE",
      "impact": "CPU exhaustion from catastrophic backtracking",
      "attackComplexity": "MEDIUM",
      "attackScenario": "Search with pattern '(a+)+$'",
      "remediation": "Sanitize regex input, escape special chars",
      "estimatedFixTime": "15 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-029",
      "category": "ReDoS",
      "severity": "MEDIUM",
      "file": "src/controllers/firm.controller.js",
      "line": "41",
      "description": "Unsanitized regex in city filter",
      "dosPotenttial": "MODERATE",
      "impact": "CPU exhaustion",
      "attackComplexity": "MEDIUM",
      "remediation": "Sanitize input",
      "estimatedFixTime": "5 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-030",
      "category": "ReDoS",
      "severity": "MEDIUM",
      "file": "src/controllers/benefit.controller.js",
      "line": "167-172",
      "description": "Multiple unsanitized regex in search",
      "dosPotenttial": "MODERATE",
      "impact": "CPU exhaustion",
      "attackComplexity": "MEDIUM",
      "remediation": "Sanitize input",
      "estimatedFixTime": "10 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-031",
      "category": "ReDoS",
      "severity": "MEDIUM",
      "file": "src/controllers/client.controller.js",
      "line": "145-149",
      "description": "Multiple unsanitized regex in search",
      "dosPotenttial": "MODERATE",
      "impact": "CPU exhaustion",
      "attackComplexity": "MEDIUM",
      "remediation": "Sanitize input",
      "estimatedFixTime": "10 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-032",
      "category": "ReDoS",
      "severity": "MEDIUM",
      "file": "src/controllers/gig.controller.js",
      "line": "72",
      "description": "Unsanitized regex in category filter",
      "dosPotenttial": "MODERATE",
      "impact": "CPU exhaustion",
      "attackComplexity": "MEDIUM",
      "remediation": "Sanitize input",
      "estimatedFixTime": "5 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-033",
      "category": "PDF Generation - No Rate Limit",
      "severity": "MEDIUM",
      "file": "src/controllers/pdfme.controller.js",
      "line": "503-541",
      "function": "generatePdf",
      "description": "No rate limiting on CPU-intensive PDF generation",
      "dosPotenttial": "MODERATE",
      "impact": "CPU exhaustion, event loop blocking",
      "attackComplexity": "LOW",
      "attackScenario": "100 concurrent PDF generation requests",
      "remediation": "Apply pdfGenerationLimiter (50 per hour)",
      "estimatedFixTime": "15 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-034",
      "category": "PDF Generation - Input Validation",
      "severity": "MEDIUM",
      "file": "src/controllers/pdfme.controller.js",
      "line": "568",
      "function": "mapInvoiceDataToInputs",
      "description": "No validation on input size - could generate 1000-page PDF",
      "dosPotenttial": "LOW",
      "impact": "CPU/memory exhaustion",
      "attackComplexity": "MEDIUM",
      "remediation": "Validate max 100 line items, max 1000 chars in notes",
      "estimatedFixTime": "15 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-035",
      "category": "PDF Generation - No Cleanup",
      "severity": "MEDIUM",
      "file": "src/controllers/pdfme.controller.js",
      "line": "574-575",
      "description": "Generated PDFs saved without cleanup job",
      "dosPotenttial": "LOW",
      "impact": "Disk space exhaustion over time",
      "attackComplexity": "LOW",
      "remediation": "Add cron job to delete PDFs older than 7 days",
      "estimatedFixTime": "30 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-036",
      "category": "Database Query Timeout",
      "severity": "MEDIUM",
      "file": "Multiple files",
      "line": "N/A",
      "description": "No maxTimeMS on queries - can hang indefinitely",
      "dosPotenttial": "MODERATE",
      "impact": "Connection pool exhaustion",
      "attackComplexity": "MEDIUM",
      "remediation": "Add .maxTimeMS(30000) to all queries",
      "estimatedFixTime": "60 minutes",
      "priority": "P2",
      "fixed": false
    },
    {
      "id": "RE-037",
      "category": "Response Size",
      "severity": "MEDIUM",
      "file": "Multiple controllers",
      "line": "N/A",
      "description": "No validation on response size - could return 100MB+ JSON",
      "dosPotenttial": "MODERATE",
      "impact": "Network bandwidth exhaustion, client crash",
      "attackComplexity": "LOW",
      "remediation": "Add response size limiter middleware (max 10MB)",
      "estimatedFixTime": "30 minutes",
      "priority": "P2",
      "fixed": false
    }
  ],
  "summary": {
    "totalEstimatedFixTime": "8-10 hours",
    "criticalFixTime": "4-5 hours",
    "highFixTime": "3-4 hours",
    "mediumFixTime": "2-3 hours",
    "phase1Duration": "1 week",
    "phase2Duration": "1 week",
    "phase3Duration": "1 week"
  },
  "recommendations": {
    "immediate": [
      "Add pagination to all database queries",
      "Implement Socket.io connection and message limits",
      "Validate report date ranges"
    ],
    "shortTerm": [
      "Implement per-user storage quotas",
      "Add file upload rate limiting",
      "Sanitize all regex inputs"
    ],
    "longTerm": [
      "Implement comprehensive monitoring and alerting",
      "Add automated cleanup jobs",
      "Create resource protection middleware"
    ]
  }
}
