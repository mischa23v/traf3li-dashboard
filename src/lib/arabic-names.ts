/**
 * Arabic Names Lookup Table
 * Maps common English names (used in Saudi Arabia) to their Arabic equivalents
 */

// Common Saudi/Arabic first names mapping
export const arabicFirstNames: Record<string, string> = {
  // Male names - most common in Saudi Arabia
  'Mishary': 'مشاري',
  'Mohammed': 'محمد',
  'Muhammad': 'محمد',
  'Mohammad': 'محمد',
  'Ahmed': 'أحمد',
  'Ahmad': 'أحمد',
  'Abdullah': 'عبدالله',
  'Abdulaziz': 'عبدالعزيز',
  'Abdulrahman': 'عبدالرحمن',
  'Abdulmajeed': 'عبدالمجيد',
  'Abdulmalik': 'عبدالملك',
  'Abdulkarim': 'عبدالكريم',
  'Abdullatif': 'عبداللطيف',
  'Abdulwahab': 'عبدالوهاب',
  'Abdulsalam': 'عبدالسلام',
  'Abdulhadi': 'عبدالهادي',
  'Abdulhamid': 'عبدالحميد',
  'Abdulnasser': 'عبدالناصر',
  'Faisal': 'فيصل',
  'Fahad': 'فهد',
  'Khaled': 'خالد',
  'Khalid': 'خالد',
  'Sultan': 'سلطان',
  'Salman': 'سلمان',
  'Saud': 'سعود',
  'Saad': 'سعد',
  'Turki': 'تركي',
  'Nasser': 'ناصر',
  'Naif': 'نايف',
  'Nawaf': 'نواف',
  'Mansour': 'منصور',
  'Bandar': 'بندر',
  'Badr': 'بدر',
  'Omar': 'عمر',
  'Othman': 'عثمان',
  'Osman': 'عثمان',
  'Ali': 'علي',
  'Hassan': 'حسن',
  'Hussein': 'حسين',
  'Hussain': 'حسين',
  'Ibrahim': 'إبراهيم',
  'Ismail': 'إسماعيل',
  'Youssef': 'يوسف',
  'Yousef': 'يوسف',
  'Yusuf': 'يوسف',
  'Waleed': 'وليد',
  'Walid': 'وليد',
  'Majed': 'ماجد',
  'Majid': 'ماجد',
  'Talal': 'طلال',
  'Tariq': 'طارق',
  'Tarek': 'طارق',
  'Rashed': 'راشد',
  'Rashid': 'راشد',
  'Rasheed': 'رشيد',
  'Hamad': 'حمد',
  'Hamdan': 'حمدان',
  'Hamza': 'حمزة',
  'Zaid': 'زيد',
  'Zayed': 'زايد',
  'Saif': 'سيف',
  'Nabil': 'نبيل',
  'Adel': 'عادل',
  'Adil': 'عادل',
  'Karim': 'كريم',
  'Kareem': 'كريم',
  'Sami': 'سامي',
  'Sameer': 'سمير',
  'Jamal': 'جمال',
  'Jameel': 'جميل',
  'Jamil': 'جميل',
  'Bilal': 'بلال',
  'Bassam': 'بسام',
  'Fares': 'فارس',
  'Faris': 'فارس',
  'Haitham': 'هيثم',
  'Hesham': 'هشام',
  'Hisham': 'هشام',
  'Ammar': 'عمار',
  'Amer': 'عامر',
  'Amir': 'أمير',
  'Anas': 'أنس',
  'Osama': 'أسامة',
  'Usama': 'أسامة',
  'Muhannad': 'مهند',
  'Mohannad': 'مهند',
  'Rami': 'رامي',
  'Raed': 'رائد',
  'Mazen': 'مازن',
  'Mazin': 'مازن',
  'Munir': 'منير',
  'Mustafa': 'مصطفى',
  'Mostafa': 'مصطفى',
  'Nader': 'نادر',
  'Saleh': 'صالح',
  'Salih': 'صالح',
  'Tamer': 'تامر',
  'Wael': 'وائل',
  'Yasser': 'ياسر',
  'Yasir': 'ياسر',
  'Yazeed': 'يزيد',
  'Yazid': 'يزيد',
  'Zaki': 'زكي',
  'Zakaria': 'زكريا',
  'Zakariya': 'زكريا',

  // Female names - most common in Saudi Arabia
  'Fatima': 'فاطمة',
  'Fatimah': 'فاطمة',
  'Aisha': 'عائشة',
  'Ayesha': 'عائشة',
  'Maryam': 'مريم',
  'Mariam': 'مريم',
  'Noura': 'نورة',
  'Nora': 'نورة',
  'Noor': 'نور',
  'Sara': 'سارة',
  'Sarah': 'سارة',
  'Hala': 'هالة',
  'Hana': 'هناء',
  'Hanaa': 'هناء',
  'Lama': 'لمى',
  'Lamia': 'لمياء',
  'Layla': 'ليلى',
  'Leila': 'ليلى',
  'Lina': 'لينا',
  'Lubna': 'لبنى',
  'Maha': 'مها',
  'Mai': 'مي',
  'May': 'مي',
  'Malak': 'ملك',
  'Mona': 'منى',
  'Muna': 'منى',
  'Nawal': 'نوال',
  'Najla': 'نجلاء',
  'Reem': 'ريم',
  'Rima': 'ريما',
  'Rana': 'رنا',
  'Rania': 'رانيا',
  'Rawdah': 'روضة',
  'Ruqaya': 'رقية',
  'Ruqayyah': 'رقية',
  'Salwa': 'سلوى',
  'Samira': 'سميرة',
  'Samar': 'سمر',
  'Shahad': 'شهد',
  'Shatha': 'شذى',
  'Shouq': 'شوق',
  'Wafa': 'وفاء',
  'Wafaa': 'وفاء',
  'Yara': 'يارا',
  'Zahra': 'زهراء',
  'Zainab': 'زينب',
  'Abeer': 'عبير',
  'Abir': 'عبير',
  'Afnan': 'أفنان',
  'Ahlam': 'أحلام',
  'Amani': 'أماني',
  'Amira': 'أميرة',
  'Arwa': 'أروى',
  'Asma': 'أسماء',
  'Asmaa': 'أسماء',
  'Basma': 'بسمة',
  'Dana': 'دانة',
  'Dania': 'دانية',
  'Dalal': 'دلال',
  'Dina': 'دينا',
  'Fadwa': 'فدوى',
  'Ghada': 'غادة',
  'Hadeel': 'هديل',
  'Haifa': 'هيفاء',
  'Hanan': 'حنان',
  'Hayat': 'حياة',
  'Hessa': 'حصة',
  'Hind': 'هند',
  'Iman': 'إيمان',
  'Joud': 'جود',
  'Khadija': 'خديجة',
  'Latifa': 'لطيفة',
}

// Common Saudi/Arabic last names mapping
export const arabicLastNames: Record<string, string> = {
  // Royal and noble family names
  'Al Saud': 'آل سعود',
  'AlSaud': 'آل سعود',
  'Al-Saud': 'آل سعود',

  // Common tribal and family names
  'Al-Rashid': 'الراشد',
  'AlRashid': 'الراشد',
  'Alrashid': 'الراشد',
  'Al-Ahmed': 'الأحمد',
  'AlAhmed': 'الأحمد',
  'Alahmed': 'الأحمد',
  'Al-Mohammed': 'المحمد',
  'AlMohammed': 'المحمد',
  'Almohammed': 'المحمد',
  'Al-Fahad': 'الفهد',
  'AlFahad': 'الفهد',
  'Alfahad': 'الفهد',
  'Al-Salem': 'السالم',
  'AlSalem': 'السالم',
  'Alsalem': 'السالم',
  'Al-Saleh': 'الصالح',
  'AlSaleh': 'الصالح',
  'Alsaleh': 'الصالح',
  'Al-Otaibi': 'العتيبي',
  'AlOtaibi': 'العتيبي',
  'Alotaibi': 'العتيبي',
  'Al-Qahtani': 'القحطاني',
  'AlQahtani': 'القحطاني',
  'Alqahtani': 'القحطاني',
  'Al-Ghamdi': 'الغامدي',
  'AlGhamdi': 'الغامدي',
  'Alghamdi': 'الغامدي',
  'Al-Dosari': 'الدوسري',
  'AlDosari': 'الدوسري',
  'Aldosari': 'الدوسري',
  'Al-Harbi': 'الحربي',
  'AlHarbi': 'الحربي',
  'Alharbi': 'الحربي',
  'Al-Zahrani': 'الزهراني',
  'AlZahrani': 'الزهراني',
  'Alzahrani': 'الزهراني',
  'Al-Shehri': 'الشهري',
  'AlShehri': 'الشهري',
  'Alshehri': 'الشهري',
  'Al-Mutairi': 'المطيري',
  'AlMutairi': 'المطيري',
  'Almutairi': 'المطيري',
  'Al-Shamri': 'الشمري',
  'AlShamri': 'الشمري',
  'Alshamri': 'الشمري',
  'Al-Enezi': 'العنزي',
  'AlEnezi': 'العنزي',
  'Alenezi': 'العنزي',
  'Al-Anazi': 'العنزي',
  'AlAnazi': 'العنزي',
  'Alanazi': 'العنزي',
  'Al-Tamimi': 'التميمي',
  'AlTamimi': 'التميمي',
  'Altamimi': 'التميمي',
  'Al-Subaie': 'السبيعي',
  'AlSubaie': 'السبيعي',
  'Alsubaie': 'السبيعي',
  'Al-Shammari': 'الشمري',
  'AlShammari': 'الشمري',
  'Alshammari': 'الشمري',
  'Al-Bishi': 'البيشي',
  'AlBishi': 'البيشي',
  'Albishi': 'البيشي',
  'Al-Malki': 'المالكي',
  'AlMalki': 'المالكي',
  'Almalki': 'المالكي',
  'Al-Juhani': 'الجهني',
  'AlJuhani': 'الجهني',
  'Aljuhani': 'الجهني',
  'Al-Yami': 'اليامي',
  'AlYami': 'اليامي',
  'Alyami': 'اليامي',
  'Al-Asiri': 'العسيري',
  'AlAsiri': 'العسيري',
  'Alasiri': 'العسيري',
  'Al-Khaldi': 'الخالدي',
  'AlKhaldi': 'الخالدي',
  'Alkhaldi': 'الخالدي',
  'Al-Omari': 'العمري',
  'AlOmari': 'العمري',
  'Alomari': 'العمري',
  'Al-Shehrani': 'الشهراني',
  'AlShehrani': 'الشهراني',
  'Alshehrani': 'الشهراني',
  'Al-Sulaimani': 'السليماني',
  'AlSulaimani': 'السليماني',
  'Alsulaimani': 'السليماني',
  'Al-Harthi': 'الحارثي',
  'AlHarthi': 'الحارثي',
  'Alharthi': 'الحارثي',
  'Al-Faifi': 'الفيفي',
  'AlFaifi': 'الفيفي',
  'Alfaifi': 'الفيفي',
  'Al-Ahmadi': 'الأحمدي',
  'AlAhmadi': 'الأحمدي',
  'Alahmadi': 'الأحمدي',
  'Al-Hamad': 'الحمد',
  'AlHamad': 'الحمد',
  'Alhamad': 'الحمد',
  'Al-Ibrahim': 'الإبراهيم',
  'AlIbrahim': 'الإبراهيم',
  'Alibrahim': 'الإبراهيم',
  'Al-Hassan': 'الحسن',
  'AlHassan': 'الحسن',
  'Alhassan': 'الحسن',
  'Al-Hussein': 'الحسين',
  'AlHussein': 'الحسين',
  'Alhussein': 'الحسين',
  'Al-Ali': 'العلي',
  'AlAli': 'العلي',
  'Alali': 'العلي',
  'Al-Omar': 'العمر',
  'AlOmar': 'العمر',
  'Alomar': 'العمر',
  'Al-Nasser': 'الناصر',
  'AlNasser': 'الناصر',
  'Alnasser': 'الناصر',
  'Al-Mansour': 'المنصور',
  'AlMansour': 'المنصور',
  'Almansour': 'المنصور',
  'Al-Turki': 'التركي',
  'AlTurki': 'التركي',
  'Alturki': 'التركي',
  'Al-Faisal': 'الفيصل',
  'AlFaisal': 'الفيصل',
  'Alfaisal': 'الفيصل',
  'Al-Sultan': 'السلطان',
  'AlSultan': 'السلطان',
  'Alsultan': 'السلطان',
  'Al-Majid': 'الماجد',
  'AlMajid': 'الماجد',
  'Almajid': 'الماجد',
  'Al-Khalid': 'الخالد',
  'AlKhalid': 'الخالد',
  'Alkhalid': 'الخالد',
}

/**
 * Check if a string contains Arabic characters
 */
export function isArabicText(text: string | undefined): boolean {
  if (!text) return false
  // Arabic Unicode range: \u0600-\u06FF (includes Arabic letters, numbers, and diacritics)
  const arabicRegex = /[\u0600-\u06FF]/
  return arabicRegex.test(text)
}

/**
 * Get Arabic first name from English name
 * Case-insensitive lookup with fallback to original name
 */
export function getArabicFirstName(englishName: string | undefined): string | undefined {
  if (!englishName) return undefined

  // If the name is already in Arabic, return it as-is
  if (isArabicText(englishName)) {
    return englishName
  }

  // Try exact match first
  if (arabicFirstNames[englishName]) {
    return arabicFirstNames[englishName]
  }

  // Try case-insensitive match
  const lowerName = englishName.toLowerCase()
  for (const [key, value] of Object.entries(arabicFirstNames)) {
    if (key.toLowerCase() === lowerName) {
      return value
    }
  }

  return undefined
}

/**
 * Get Arabic last name from English name
 * Case-insensitive lookup with fallback to original name
 */
export function getArabicLastName(englishName: string | undefined): string | undefined {
  if (!englishName) return undefined

  // If the name is already in Arabic, return it as-is
  if (isArabicText(englishName)) {
    return englishName
  }

  // Try exact match first
  if (arabicLastNames[englishName]) {
    return arabicLastNames[englishName]
  }

  // Try case-insensitive match
  const lowerName = englishName.toLowerCase()
  for (const [key, value] of Object.entries(arabicLastNames)) {
    if (key.toLowerCase() === lowerName) {
      return value
    }
  }

  return undefined
}

/**
 * Get display name based on locale
 * Priority:
 * 1. Arabic locale: Use Arabic name if available, else lookup from English, else fallback to English
 * 2. English locale: Use English name
 */
export function getLocalizedFirstName(
  firstName: string | undefined,
  firstNameAr: string | undefined,
  locale: string
): string {
  if (locale === 'ar') {
    // First try user's stored Arabic name
    if (firstNameAr) return firstNameAr
    // Then try lookup from English name
    const lookupArabic = getArabicFirstName(firstName)
    if (lookupArabic) return lookupArabic
    // Fallback to English name
    return firstName || ''
  }
  // English locale - use English name
  return firstName || ''
}

/**
 * Get display last name based on locale
 */
export function getLocalizedLastName(
  lastName: string | undefined,
  lastNameAr: string | undefined,
  locale: string
): string {
  if (locale === 'ar') {
    // First try user's stored Arabic name
    if (lastNameAr) return lastNameAr
    // Then try lookup from English name
    const lookupArabic = getArabicLastName(lastName)
    if (lookupArabic) return lookupArabic
    // Fallback to English name
    return lastName || ''
  }
  // English locale - use English name
  return lastName || ''
}

/**
 * Get full localized name
 */
export function getLocalizedFullName(
  firstName: string | undefined,
  lastName: string | undefined,
  firstNameAr: string | undefined,
  lastNameAr: string | undefined,
  locale: string
): string {
  const localizedFirst = getLocalizedFirstName(firstName, firstNameAr, locale)
  const localizedLast = getLocalizedLastName(lastName, lastNameAr, locale)

  if (localizedFirst && localizedLast) {
    return `${localizedFirst} ${localizedLast}`
  }
  return localizedFirst || localizedLast || ''
}
